# 8 月 16 日

## rCore-SMP

发现我们启动时就已经知道总的 SMP 核数了，所以初始化一些资源（如处理器抽象）会比较方便了。但是初始化花了我很大功夫（```UPSafeCell``` 似乎没有实现 ```Copy``` 特型）。看到了[用 collect](https://users.rust-lang.org/t/how-to-initialize-vec-option-t-with-none/30580) 才成功初始化。

关于如何进行进程调度，我想，目前为了简单起见，可以从更改创建进程的代码开始入手。但是在做的过程中发现，内核崩溃时只有一句最后崩溃的位置，为了调试方便，需要完善一下崩溃时的程序输出，最好能有栈回溯。给它加上了 SMP 锁，打开 os/src/lang_items.rs 中现有代码里的注释，但却发现只输出了栈回溯的几个 16 进制地址，没有对应到文件和行号上。在 GitHub 上看到一个 [Pull Request](https://hub.nuaa.cf/rcore-os/rCore-Tutorial-v3/pull/105)，但不知道为什么没有被合并。

## 总结

加了 rCore 群才看见有个“多核参考”的群公告。那我们为什么要自己做呢？我觉得，OS 都是在演化中发展的，自己动手学习仍然是有可取之处的。此外，修改的文件越来越多，应该用 Git 提交一下。